<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Verdana';
	font-size: 8pt;
	color: #E0E2E4;
}
.sc0 {
}
.sc1 {
	color: #66747B;
}
.sc2 {
	color: #66747B;
}
.sc4 {
	color: #FFCD22;
}
.sc5 {
	font-weight: bold;
	color: #93C763;
}
.sc6 {
	color: #EC7600;
}
.sc9 {
	color: #A082BD;
}
.sc10 {
	color: #E8E2B7;
}
.sc11 {
}
.sc16 {
	color: #678CB1;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #000000; "><span class="sc9">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;limits.h&gt; </span><span class="sc2">//för INT_MIN
</span><span class="sc0">
</span><span class="sc1">/* Övning 10.4, Sida 231

Skriv ett program som läser en loggfil för en datasal och som undersöker
vilken användare som har varit inloggad under längst tid.

Användarens namn och totala tid ska skrivas ut!


Loggfilen är en textfil där användarnamnen står på var sin rad, 
med inloggade minuter (per tillfälle) efter varje namn.

Ex:

kallep 25 40 15
hannak 30 45 15 33 14
svenneb 14 23 58 74 10
hakans 12 12 12 13 12 */</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">main</span><span class="sc10">(){</span><span class="sc0">
    </span><span class="sc11">FILE</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">loggfil</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fopen</span><span class="sc10">(</span><span class="sc6">"loggfil_datasal2.txt"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"r"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc1">/*Variabler för kopiering från textfil, hållare av användarnamn, 
    samt hållare av användare med max antal minuter loggade*/</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">s</span><span class="sc10">[</span><span class="sc4">100</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc11">anvandarnamn</span><span class="sc10">[</span><span class="sc4">30</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc11">anvandare_maxtid</span><span class="sc10">[</span><span class="sc4">30</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc1">/*Variabler för hållare av tid session/totalt, i=för förlänging av stränglängd att läsa ifrån, 
    maxtid sätts till minsta värdet en int kan ha, 
    så den sätts till den första totala loggade tiden första gången*/</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">tid_total</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">tid_session</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">inlasta_tecken</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">maxtid</span><span class="sc10">=</span><span class="sc11">INT_MIN</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc1">/*whilesats som körs så länge text kan läsas från textfilen, 
    fgets skriver till variabeln s, från textfilen, en rad i taget eller tills 100 tecken har lästs in*/</span><span class="sc0">
    </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">fgets</span><span class="sc10">(</span><span class="sc11">s</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">100</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">loggfil</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">){</span><span class="sc0">
        </span><span class="sc11">tid_total</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc1">/* sscanf fungerar som scanf fast den får texten från en textsträng (s i detta fall). Då jag
        antar att användarnamnen består av ett ord, så kan jag använda en enda sscanf*/</span><span class="sc0">
        </span><span class="sc11">sscanf</span><span class="sc10">(</span><span class="sc11">s</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"%s"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">anvandarnamn</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc2">//i sätts till längen av det inlästa användarnamnet, så att nästa inläsning blir ett siffer-tal med s+i
</span><span class="sc0">        </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">anvandarnamn</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc1">/*whilsesats som körs så länge sscanf returnerar 1, dvs en inläsning har lyckats, 
        %n är antal inlästa tecken som sscanf läser in, sätts till inlasta_tecken */</span><span class="sc0">
        </span><span class="sc5">while</span><span class="sc10">(</span><span class="sc11">sscanf</span><span class="sc10">(</span><span class="sc11">s</span><span class="sc10">+</span><span class="sc11">i</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"%d%n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">tid_session</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">inlasta_tecken</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">){</span><span class="sc0">
            </span><span class="sc2">//tid_total sätts till summan av sessionstiderna
</span><span class="sc0">            </span><span class="sc11">tid_total</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc11">tid_session</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc2">//i ökar med antal inlästa tecken, så att nästa inläsning ovan blir till tecknen efter den inlästa siffran
</span><span class="sc0">            </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc11">inlasta_tecken</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc1">/*om maxtid är mindre än den totala tiden sätts maxtid till totaltid, 
        och användarnamnet kopieras till en hållare med strcpy. OBS det går inte använda array = array */</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">maxtid</span><span class="sc10">&lt;</span><span class="sc11">tid_total</span><span class="sc10">){</span><span class="sc0">
            </span><span class="sc11">maxtid</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">tid_total</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">anvandare_maxtid</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">anvandarnamn</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Användaren '%s' har använt datasalen mest!\nTotal loggad tid: %d minuter"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">anvandare_maxtid</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">maxtid</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span></div></body>
</html>
